# Структура Excel каталога с отдельными листами

## Общая структура

Excel файл разделен на **отдельные листы для каждой категории**:

- **Импланты** - лист с имплантами
- **Протетика** - лист с протетикой
- **Лаборатория** - лист с лабораторными товарами
- **Наборы** - лист с наборами
- **материалы** - лист с материалами
- **Инструкция** - лист с инструкциями (не обрабатывается)

## Структура каждого листа

На каждом листе (кроме "Инструкция") одинаковая структура колонок **БЕЗ колонки "Категория"**:

| Линейка | Название товара | Артикул (1C) | Тип | Диаметр | Длина | Высота абатмента | Ед. изм. |
|---------|-----------------|--------------|-----|---------|-------|------------------|----------|

**Важно:** Категория определяется названием листа, колонка "Категория" не нужна!

## Правила заполнения по категориям

### Импланты (лист "Импланты")

| Линейка | Название товара | Артикул (1C) | Тип | Диаметр | Длина | Высота абатмента | Ед. изм. |
|---------|-----------------|--------------|-----|---------|-------|------------------|----------|
| AnyRidge | AnyRidge 3507 | AR-3507 | (пусто) | 3.5 | 7.0 | (пусто) | шт |
| AnyRidge | AnyRidge 3508 | AR-3508 | (пусто) | 3.5 | 8.0 | (пусто) | шт |
| AnyOne | AnyOne 3507 C | AO-3507C | (пусто) | 3.5 | 7.0 | (пусто) | шт |

**Правила:**
- Линейка: название линейки (AnyRidge, AnyOne и т.д.)
- Название товара: полное название импланта
- Тип: оставить пустым
- Диаметр и Длина: обязательно заполнить
- Высота абатмента: оставить пустым

### Протетика (лист "Протетика")

| Линейка | Название товара | Артикул (1C) | Тип | Диаметр | Длина | Высота абатмента | Ед. изм. |
|---------|-----------------|--------------|-----|---------|-------|------------------|----------|
| AnyRidge | EZ Post Abutment | EP-AR-45-15-25-ST | прямой | 4.5 | 1.5 | 2.5 | шт |
| AnyRidge | EZ Post Abutment | EP-AR-45-20-25-ST | прямой | 4.5 | 2.0 | 2.5 | шт |
| AnyRidge | EZ Post Abutment | EP-AR-45-15-25-AN | угловой | 4.5 | 1.5 | 2.5 | шт |
| AnyOne | EZ Post Abutment | EP-AO-45-15-25-ST | прямой | 4.5 | 1.5 | 2.5 | шт |

**Правила:**
- Линейка: **линейка импланта** (AnyRidge, AnyOne и т.д.)
- Название товара: название товара (EZ Post Abutment, Healing Abutment и т.д.)
- Тип: обязательно "прямой" или "угловой"
- Диаметр, Длина (высота десны) и Высота абатмента: обязательно заполнить

### Лаборатория (лист "Лаборатория")

| Линейка | Название товара | Артикул (1C) | Тип | Диаметр | Длина | Высота абатмента | Ед. изм. |
|---------|-----------------|--------------|-----|---------|-------|------------------|----------|
| AnyRidge | Lab Analog | LA-AR-45-15-25 | (пусто) | 4.5 | 1.5 | 2.5 | шт |
| AnyOne | Lab Analog | LA-AO-45-15-25 | (пусто) | 4.5 | 1.5 | 2.5 | шт |

**Правила:**
- Линейка: **линейка импланта** (AnyRidge, AnyOne и т.д.)
- Название товара: название товара (Lab Analog и т.д.)
- Тип: может быть пустым
- Диаметр, Длина (высота десны) и Высота абатмента: обязательно заполнить

### Наборы (лист "Наборы")

| Линейка | Название товара | Артикул (1C) | Тип | Диаметр | Длина | Высота абатмента | Ед. изм. |
|---------|-----------------|--------------|-----|---------|-------|------------------|----------|
| (пусто) | Anchor Kit (AO) KAGAS3001 | KAGAS3001 | (пусто) | (пусто) | (пусто) | (пусто) | комплект |
| (пусто) | Anchor Kit (AR) KAGAS3000 | KAGAS3000 | (пусто) | (пусто) | (пусто) | (пусто) | комплект |

**Правила:**
- Линейка: может быть пустым
- Название товара: полное название набора
- Тип, Диаметр, Длина, Высота абатмента: оставить пустыми

### материалы (лист "материалы")

| Линейка | Название товара | Артикул (1C) | Тип | Диаметр | Длина | Высота абатмента | Ед. изм. |
|---------|-----------------|--------------|-----|---------|-------|------------------|----------|
| (пусто) | Fiziodisfensor COXO | FZ-COXO | (пусто) | (пусто) | (пусто) | (пусто) | шт |
| (пусто) | Fiziodisfensor Ki-20 | FZ-KI20 | (пусто) | (пусто) | (пусто) | (пусто) | шт |

**Правила:**
- Линейка: может быть пустым
- Название товара: полное название материала
- Тип, Диаметр, Длина, Высота абатмента: оставить пустыми

## Создание шаблона

```powershell
python create_catalog_template.py
```

Создаст файл `catalog_template.xlsx` с:
- Отдельными листами для каждой категории
- Примерными данными на каждом листе
- Листом "Инструкция" с подробными правилами

## Загрузка каталога

```powershell
python load_catalog_from_excel.py catalog_template.xlsx
```

Скрипт автоматически:
- Определит категорию по названию листа
- Загрузит данные из каждого листа
- Объединит все в единый каталог
- Создаст `catalog_data.py` и `catalog.json`

## Структура данных в catalog_data.py

После загрузки данные хранятся в следующем формате:

### Импланты
```python
CATALOG = {
    "Импланты": {
        "AnyRidge": {  # Линейка
            3.5: {  # Диаметр
                7.0: {  # Длина
                    "name": "AnyRidge 3507",
                    "sku": "AR-3507",
                    "unit": "шт"
                },
                8.0: {...}
            }
        }
    }
}
```

### Протетика/Лаборатория
```python
CATALOG = {
    "Протетика": {
        "EZ Post Abutment": {  # Название товара
            "AnyRidge": {  # Линейка импланта
                "прямой": {  # Тип
                    4.5: {  # Диаметр
                        1.5: {  # Высота десны
                            2.5: {  # Высота абатмента
                                "name": "EZ Post Abutment прямой Ø4.5 Д1.5 А2.5",
                                "sku": "EP-AR-45-15-25-ST",
                                "unit": "шт"
                            }
                        }
                    }
                }
            }
        }
    }
}
```

## Преимущества разделения на листы

1. ✅ **Удобство заполнения** - каждый лист содержит только одну категорию
2. ✅ **Простота управления** - легко найти и отредактировать товары нужной категории
3. ✅ **Меньше ошибок** - нет необходимости указывать категорию в каждой строке
4. ✅ **Масштабируемость** - легко добавить новые категории (новые листы)
5. ✅ **Чистота данных** - категория определяется автоматически по названию листа

## Важно

- **Категория определяется названием листа**, не нужно заполнять колонку "Категория"
- Каждый лист должен содержать только товары одной категории
- Артикул (1C) обязателен для всех товаров
- Не удаляйте строку с заголовками
- Не оставляйте пустые строки между товарами (можно, но не рекомендуется)
