# Интеграция каталога из Excel

## Что было сделано

1. **Создан скрипт загрузки** (`load_megagen_excel.py`)
   - Читает данные из `Megagenbot.xlsx`
   - Автоматически определяет структуру (листы = категории, строки = товары)
   - Извлекает диаметры и длины из названий товаров (если возможно)
   - Генерирует `catalog_data.py` и `catalog.json`

2. **Обновлён каталог в боте**
   - `keyboards/manager_kbs.py` теперь использует данные из `catalog_data.py`
   - Поддержка товаров с размерами (диаметр × длина)
   - Поддержка товаров без размеров (наборы, материалы, абатменты)

3. **Обновлены обработчики**
   - `handlers/manager.py` поддерживает оба типа товаров
   - Корректная работа с корзиной для всех типов товаров

## Статистика загруженных данных

- **Категорий**: 5 (Импланты, Протетика, Лаборатория, Наборы, материалы)
- **Линеек**: 22
- **Товаров с размерами**: 43
- **Товаров без размеров**: 599
- **Всего товаров**: 642

## Как обновить каталог

1. Отредактируйте `Megagenbot.xlsx` (добавьте/удалите товары)
2. Запустите:
   ```powershell
   python load_megagen_excel.py
   ```
3. Перезапустите бота

## Структура Excel файла

- **Листы** = категории (Импланты, Протетика, и т.д.)
- **Первая строка блока** = название линейки
- **Следующие строки** = товары этой линейки
- **Колонка 1** = название товара
- **Колонка 2** = количество на складе (не используется в каталоге, только для справки)

## Формат названий товаров

Скрипт автоматически пытается извлечь диаметр и длину из названий:

- `AnyOne 3507 C` → диаметр 3.5, длина 7.0
- `AnyOne 3510 C` → диаметр 3.5, длина 10.0
- `AnyRidge 4008` → диаметр 4.0, длина 8.0

Если размеры не удалось извлечь, товар попадает в категорию "без размеров".

## Использование в боте

1. Менеджер открывает каталог через `/menu` или кнопку "Каталог продукции"
2. Выбирает категорию → линейку
3. Для товаров с размерами: выбирает диаметр → длину
4. Для товаров без размеров: видит список товаров напрямую
5. Добавляет в корзину и оформляет заказ

## Файлы

- `Megagenbot.xlsx` - исходный файл с каталогом
- `catalog_data.py` - Python структура (автогенерируется)
- `catalog.json` - JSON версия (автогенерируется)
- `load_megagen_excel.py` - скрипт загрузки

## Примечания

- `catalog_data.py` не редактируется вручную - он перезаписывается при каждом запуске `load_megagen_excel.py`
- Если `catalog_data.py` не найден, используется fallback с минимальными данными
- Товары без размеров не проверяются на остатки (можно добавить позже)
