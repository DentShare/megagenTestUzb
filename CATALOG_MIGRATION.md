# Миграция каталога

Скрипт `migrate_catalog.py` выполняет полную миграцию каталога для полноценной работы бота.

## Что делает миграция

1. **Загружает каталог из Excel** — читает данные из файла (catalog_template.xlsx, Megagenbot.xlsx или catalog.xlsx)
2. **Генерирует catalog_data.py** — Python-модуль с данными каталога для бота
3. **Сохраняет catalog.json** — JSON-версия для резервного копирования и интеграций
4. **Инициализирует catalog_stock.json** — остатки по артикулам (для USE_CATALOG_STOCK)

## Запуск миграции

### Автоматический поиск файла

```powershell
python migrate_catalog.py
```

Скрипт ищет файл в порядке: `catalog_template.xlsx` → `Megagenbot.xlsx` → `catalog.xlsx`

### Указание файла

```powershell
python migrate_catalog.py путь/к/каталогу.xlsx
```

## Когда запускать

- **Первый запуск бота** — перед стартом выполните миграцию
- **Обновление каталога** — после изменений в Excel
- **Переход на новый Excel** — при смене источника данных
- **Восстановление** — если catalog_data.py повреждён или отсутствует

## Результат

После успешной миграции:

- `catalog_data.py` — обновлён
- `catalog.json` — обновлён
- `catalog_stock.json` — инициализирован остатками из Excel (колонка «Количество»)

Перезапустите бота для применения изменений.

## Связь с другими скриптами

| Скрипт | Назначение |
|--------|------------|
| `migrate_catalog.py` | Полная миграция (рекомендуется) |
| `load_catalog_from_excel.py` | Только загрузка Excel → catalog_data.py + catalog.json |
| `create_catalog_template.py` | Создание пустого шаблона Excel |

## Автосинхронизация при старте

При `CATALOG_AUTO_SYNC=true` (по умолчанию) бот при запуске сам загружает каталог из Excel. Миграция нужна, если:

- автосинхронизация отключена;
- требуется явно обновить каталог без перезапуска;
- нужно инициализировать catalog_stock до первого запуска.
