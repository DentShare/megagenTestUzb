# Структура Excel файла каталога

## Общая структура

Excel файл разделен на **отдельные листы для каждой категории**:

- **Импланты** - лист с имплантами
- **Протетика** - лист с протетикой
- **Лаборатория** - лист с лабораторными товарами
- **Наборы** - лист с наборами
- **материалы** - лист с материалами
- **Инструкция** - лист с инструкциями (не обрабатывается)

## Настройка: catalog_config.py

Все параметры маппинга и навигации настраиваются в **catalog_config.py**:

| Параметр | Описание |
|----------|----------|
| `EXCEL_COLUMN_KEYWORDS` | Ключевые слова для поиска колонок по заголовкам |
| `CATEGORY_STRUCTURE` | Структура навигации для каждой категории (подкатегории, типы, высоты) |
| `TYPE_ANGLES` | Список углов (градусов), распознаваемых как «тип»: `(0, 17, 25, 30, 15, 20)` |
| `DIAMETER_RANGE` | Диапазон диаметров `(2.0, 10.0)` — числа в нём не считаются типами |
| `SHEET_TO_CATEGORY` | Маппинг названий листов на категории |
| `SKIP_SHEETS` | Листы, которые не обрабатываются |
| `CATEGORIES_SHOWN_IMMEDIATELY` | Сколько первых категорий показывать сразу при входе в каталог. Остальные — в кнопке «Дополнительно». По умолчанию: 2 (Импланты, Протетика) |

**Важно:** Числа в диапазоне диаметров (2.0–10.0), но не в списке углов (0, 17, 25, 30, 15, 20), **не** отображаются как типы. Это устраняет появление диаметров (4.5, 5.5) в меню выбора типа.

## Структура каждого листа

### Протетика, Лаборатория, Наборы, материалы (с подкатегориями)

| Категория | Линейка | Название товара | Артикул (1C) | Тип | Диаметр | Длина | Высота абатмента | Ед. изм. | Показывать |
|-----------|---------|-----------------|--------------|-----|---------|-------|------------------|----------|------------|
| EzPost    | AnyRidge | EZ Post Abutment | EP-AR-45-15-25 | 0 | 4.5 | 1.5 | 2.5 | шт | 1 |

### Импланты (без подкатегорий)

| Линейка | Название товара | Артикул (1C) | Тип | Диаметр | Длина | Высота абатмента | Ед. изм. | Показывать |
|---------|-----------------|--------------|-----|---------|-------|------------------|----------|------------|
| AnyRidge | AnyRidge 3507 | AR-3507 | (пусто) | 3.5 | 7.0 | (пусто) | шт | 1 |

**Примечания:**
- Для имплантов колонка **«Диаметр»**: в первую очередь ищется просто число, затем — число в `[]` отдельно.
  1. **Просто число**: `3.5`, `3,5` — один продукт
  2. **С указанием диаметра тела**: `4.5 [3.8]` — **другой продукт**, даже если первое число совпадает. В каталоге это отдельные позиции.
- Колонка **"Категория"** — первый уровень навигации (EzPost, ZrGen, LabAnalog и т.д.). Если пусто — «Основное». Используется только для Протетики, Лаборатории, Наборов, материалов.
- Колонка **"Линейка"** — второй уровень (AnyRidge, AnyOne и т.д.).
- Колонка **"Показывать"** (опциональна) — видимость в меню:
  - `1`, `да`, `yes`, `показывать`, `show`, `true`, `видно`, `visible` — показывать сразу
  - `0`, `нет`, `no`, `дополнительно`, `additional`, `false`, `скрыть`, `hide` — показывать в кнопке «Дополнительно»

## Правила заполнения по категориям

### Импланты

| Линейка | Название товара | Артикул (1C) | Тип | Диаметр | Длина | Высота абатмента | Ед. изм. |
|---------|-----------------|--------------|-----|---------|-------|------------------|----------|
| AnyRidge | AnyRidge 3507 | AR-3507 | (пусто) | 3.5 | 7.0 | (пусто) | шт |
| AnyRidge | AnyRidge 3508 | AR-3508 | (пусто) | 3.5 | 8.0 | (пусто) | шт |
| AnyOne | AnyOne 3507 C | AO-3507C | (пусто) | 3.5 | 7.0 | (пусто) | шт |

**Правила:**
- Линейка: название линейки (AnyRidge, AnyOne и т.д.)
- Название товара: полное название импланта
- Тип: оставить пустым
- Диаметр и Длина: обязательно заполнить. Варианты: `3.5` или `4.5 [3.8]` (основной диаметр + диаметр тела в скобках отдельно)
- Высота абатмента: оставить пустым

### Протетика

| Линейка | Название товара | Артикул (1C) | Тип | Диаметр | Длина | Высота абатмента | Ед. изм. |
|---------|-----------------|--------------|-----|---------|-------|------------------|----------|
| AnyRidge | EZ Post Abutment | EP-AR-45-15-25-ST | 0 | 4.5 | 1.5 | 2.5 | шт |
| AnyRidge | EZ Post Abutment | EP-AR-45-20-25-ST | 0 | 4.5 | 2.0 | 2.5 | шт |
| AnyRidge | EZ Post Abutment | EP-AR-45-15-25-AN | 17 | 4.5 | 1.5 | 2.5 | шт |
| AnyOne | EZ Post Abutment | EP-AO-45-15-25-ST | 0 | 4.5 | 1.5 | 2.5 | шт |

**Правила:**
- Линейка: линейка импланта (AnyRidge, AnyOne и т.д.)
- Название товара: название товара (EZ Post Abutment, Healing Abutment и т.д.)
- Тип: градусы угла (0, 17, 25, 30 и т.д.). 0 = прямой, другие значения = угловой с указанным углом. Вариант **[N]** — предписание N (без шестигранника): можно указать «0 [N]», «17 [N]», «30 [N]» или «[N]»
- Диаметр, Длина (высота десны) и Высота абатмента: обязательно заполнить

### Лаборатория

| Линейка | Название товара | Артикул (1C) | Тип | Диаметр | Длина | Высота абатмента | Ед. изм. |
|---------|-----------------|--------------|-----|---------|-------|------------------|----------|
| AnyRidge | Lab Analog | LA-AR-45-15-25 | (пусто) | 4.5 | 1.5 | 2.5 | шт |
| AnyOne | Lab Analog | LA-AO-45-15-25 | (пусто) | 4.5 | 1.5 | 2.5 | шт |

**Правила:**
- Линейка: линейка импланта (AnyRidge, AnyOne и т.д.)
- Название товара: название товара (Lab Analog и т.д.)
- Тип: может быть пустым
- Диаметр, Длина (высота десны) и Высота абатмента: обязательно заполнить

### Наборы

| Линейка | Название товара | Артикул (1C) | Тип | Диаметр | Длина | Высота абатмента | Ед. изм. |
|---------|-----------------|--------------|-----|---------|-------|------------------|----------|
| (пусто) | Anchor Kit (AO) KAGAS3001 | KAGAS3001 | (пусто) | (пусто) | (пусто) | (пусто) | комплект |
| (пусто) | Anchor Kit (AR) KAGAS3000 | KAGAS3000 | (пусто) | (пусто) | (пусто) | (пусто) | комплект |

**Правила:**
- Линейка: может быть пустым
- Название товара: полное название набора
- Тип, Диаметр, Длина, Высота абатмента: оставить пустыми

### материалы

| Линейка | Название товара | Артикул (1C) | Тип | Диаметр | Длина | Высота абатмента | Ед. изм. |
|---------|-----------------|--------------|-----|---------|-------|------------------|----------|
| (пусто) | Fiziodisfensor COXO | FZ-COXO | (пусто) | (пусто) | (пусто) | (пусто) | шт |
| (пусто) | Fiziodisfensor Ki-20 | FZ-KI20 | (пусто) | (пусто) | (пусто) | (пусто) | шт |

**Правила:**
- Линейка: может быть пустым
- Название товара: полное название материала
- Тип, Диаметр, Длина, Высота абатмента: оставить пустыми

## Создание шаблона

```powershell
python create_catalog_template.py
```

Создаст файл `catalog_template.xlsx` с отдельными листами для каждой категории и примерами заполнения.

## Загрузка каталога

```powershell
python load_catalog_from_excel.py catalog_template.xlsx
```

Скрипт автоматически:
- Определит категорию по названию листа
- Загрузит данные из каждого листа
- Объединит все в единый каталог
- Создаст `catalog_data.py` и `catalog.json`

## Важно

- **Категория определяется названием листа** — колонка "Категория" на листе — это **подкатегория** (EzPost, ZrGen и т.д.), а не основная категория.
- Каждый лист должен содержать только товары одной категории.
- Артикул (1C) обязателен для синхронизации с 1C.
- Не удаляйте строку с заголовками.
- Не оставляйте пустые строки между товарами.

## Изменение настроек (catalog_config.py)

- **Добавить новый угол (тип):** добавьте число в `TYPE_ANGLES`, например `(0, 17, 25, 30, 15, 20, 35)`.
- **Изменить диапазон диаметров:** измените `DIAMETER_RANGE`, например `(1.5, 12.0)`.
- **Сколько категорий показывать сразу:** измените `CATEGORIES_SHOWN_IMMEDIATELY` (по умолчанию 2 — первые два листа: Импланты, Протетика; остальные в «Дополнительно»).
- **Добавить ключевые слова для колонок:** добавьте в `EXCEL_COLUMN_KEYWORDS` в нужный список, например `"diameter": ["диаметр", "diameter", "ø", "d", "диам"]`.

## Преимущества разделения на листы

1. **Удобство заполнения** - каждый лист содержит только одну категорию
2. **Простота управления** - легко найти и отредактировать товары нужной категории
3. **Меньше ошибок** - нет необходимости указывать категорию в каждой строке
4. **Масштабируемость** - легко добавить новые категории (новые листы)
